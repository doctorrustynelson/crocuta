<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Crocuta by doctorrustynelson</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Crocuta</h1>
        <h2>Node Map Reduce and Distributed Computing</h2>
        <a href="https://github.com/doctorrustynelson/crocuta" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p><a href="http://travis-ci.org/doctorrustynelson/crocuta"><img src="https://img.shields.io/travis/doctorrustynelson/crocuta.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/doctorrustynelson/crocuta"><img src="http://img.shields.io/coveralls/doctorrustynelson/crocuta.svg" alt="Coverage Status"></a>
<a href="https://npmjs.org/package/crocuta"><img src="https://img.shields.io/npm/v/crocuta.svg" alt="NPM Version"></a>
<img src="https://img.shields.io/npm/l/crocuta.svg" alt="NPM License"></p>

<h2>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>Crocuta is at its core a distributed computing system written atop the nodejs ecosystem.  This constantly evolving ecosystem of modules allows for an ever growing variety of possibilities.  The choice of this ecosystem was fueled by a desire to solve some of the frustrations that some of the major players in this field are plagued by.  Here are just some of the frustrations that this system attempt to rectify:</p>

<h4>
<a id="just-do-something-damn-it" class="anchor" href="#just-do-something-damn-it" aria-hidden="true"><span class="octicon octicon-link"></span></a>Just Do Something Damn It!</h4>

<p>It really ruins the mood when a bunch of friends decide to get together to do something and are stuck waiting for that one guy who is running really late.  This happens in computers when one aspect of a process/system/algorithm needs to wait for another process/system/algorithm to finish.  There are much better things to do then just fly around and around in a holding pattern.  One of the key aspects of nodejs is its asynchronous execution which when used properly can eliminate blocking and wasted time.  Crocuta adopted this principle and utilizes it as one of the corner stones of the system.</p>

<h4>
<a id="what-do-you-mean-the-wrong-version--youve-been-running-for-half-an-hour" class="anchor" href="#what-do-you-mean-the-wrong-version--youve-been-running-for-half-an-hour" aria-hidden="true"><span class="octicon octicon-link"></span></a>What Do You Mean The Wrong Version?  You've Been Running For Half an Hour!</h4>

<p>Dependency management in many systems is neglected because their developers don't have to deal with it when their working with the system.  They always have the right version; it's the one they are working on.  In many systems this results in very weird phenomena such as the systems crashing after running for a significant amount of time without even a hint of something wrong before crashing because a "Class" was missing. Nodejs is very fortunate to have npm which not only makes getting new libraries and tools easy but also beyond simple to manage.  Crocuta's vision explicitly aims to emulate this ease of use with dependency management.</p>

<h4>
<a id="one-second-let-me-check-the-system-specs" class="anchor" href="#one-second-let-me-check-the-system-specs" aria-hidden="true"><span class="octicon octicon-link"></span></a>One Second Let Me Check The System Specs.</h4>

<p>The back bone of any distributed computing system is its compute power.  For some that means specialized hardware and huge monitoring systems to keep the back end cluster running.  Taking a page out of Hadoop's book Crocuta is designed to run on as many systems (independent of complexity) as possible.  Since Crocuta is backed by nodejs and written in JavaScript it can run where ever a traditional browser can run with plans for Crocuta to close the gap between user and system by actually allowing aspects of itself to run in a traditional browser. </p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>Before attempting to install Crocuta itself confirm that you have nodejs and npm installed.  If not then you can get them from <a href="http://nodejs.org/">nodejs.org</a>.</p>

<h3>
<a id="install-the-crocuta-cli" class="anchor" href="#install-the-crocuta-cli" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install the Crocuta CLI</h3>

<pre><code>npm install -g crocuta
</code></pre>

<h3>
<a id="install-the-crocuta-client" class="anchor" href="#install-the-crocuta-client" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install the Crocuta client</h3>

<pre><code>npm install crocuta 
</code></pre>

<h3>
<a id="a-simple-map-reduce-script" class="anchor" href="#a-simple-map-reduce-script" aria-hidden="true"><span class="octicon octicon-link"></span></a>A Simple Map-Reduce Script</h3>

<pre><code>#!/usr/bin/env node

var fs = require( 'fs' );
var path = require( 'path' );
var crocuta = require( 'crocuta' )( );

var job = crocuta.createJob( 'word-count' )
    .joule( function( ){
        fileSystem.getKeysUnder( input, function( keys ){
            done( keys.map( function( key ){
                return input + '.' + key;
            } ) );
        } );
    }, 'directory contents' )
        .joule( function( ){
            var mapping = {};
            var count = input.length;

            function callback( key, locations ){
                mapping[ key ] = locations;
                if( --count &lt;= 0 ){
                    done( mapping );
                }
            }

            input.forEach( function( key ){
                fileSystem.getLocationsOf( key, function( locations ){
                callback( key, locations );
            } );
        } );
    }, 'file mapper' )
    .o2mjoule( 'key2loc' ) // Proprietary Joule.
    .joule( function( ){
        done( fileSystem.readSync( input ).toString().split( ' ' ) );
    }, 'content splitter' )
    .m2ojoule( function( ){
        var result = { };
        var keys = Object.keys( input );
        keys.forEach( function( key ){
            input[ key ].forEach( function( input ){
                result[ input ] = ( result[ input ] === undefined ? 1 : result[ input ] + 1 );
            } );
        } );
        done( result );
    }, 'word counter' );

function run( ){
    job.send( function( err, compiled_job ){
        compiled_job.start( 'inputdir', function( err, result ){
             console.log( result );
             crocuta.stop( );
        } );
    } );
}

fs.readdir( '/input', function( err, files ){
    var num_files_left = files.length;
    crocuta.onReady( function( ){
        files.forEach( function( file ){
            fs.readFile( path.resolve( '/input', file ), function( err, contents ){
                crocuta.upload( 'inputdir.' + file, contents, function( err ){
                    if( --num_files_left == 0 )
                        run( );
                } );
            } );
        } );    
    } );
} );
</code></pre>

<h3>
<a id="running-map-reduce-script-locally" class="anchor" href="#running-map-reduce-script-locally" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running Map-Reduce Script Locally</h3>

<p>Crocuta currently is lacking in some of its management tooling so this step may seem extreme (and it is).  This issue is being worked on.</p>

<p>Open four terminals (or command lines) and in each run one of the following commands:</p>

<ul>
<li><code>crocuta start shenzi</code></li>
<li><code>crocuta start banzai</code></li>
<li><code>crocuta start ed</code></li>
<li><code>node script.js</code></li>
</ul>

<h2>
<a id="note" class="anchor" href="#note" aria-hidden="true"><span class="octicon octicon-link"></span></a>Note</h2>

<p>Crocuta is still in its infancy and is in a constant state of flux as it progresses through it's initial development stages.  It may be best to consider it as currently at a pre-alpha or tech-demo stage.  Use at your own discretion.</p>

<h2>
<a id="resources" class="anchor" href="#resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resources</h2>

<ul>
<li><a href="https://www.npmjs.com/package/crocuta">Crocuta on NPM</a></li>
<li><a href="https://github.com/doctorrustynelson/crocuta">GitHub</a></li>
<li><a href="https://github.com/doctorrustynelson/crocuta/wiki">Wiki</a></li>
<li><a href="https://github.com/doctorrustynelson/crocuta/issues">Issues</a></li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/doctorrustynelson/crocuta/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/doctorrustynelson/crocuta/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/doctorrustynelson/crocuta"></a> is maintained by <a href="https://github.com/doctorrustynelson">doctorrustynelson</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
